# Attendance Tracker - Система учета посещаемости сотрудников

Веб-приложение для автоматизированного учета опозданий, прогулов и других видов отсутствия сотрудников. Система реализует разделение ролей (сотрудник/администратор) и предоставляет полный цикл обработки записей от создания до подтверждения.

## Содержание

1. [Описание проекта](#описание-проекта)
2. [Технологический стек](#технологический-стек)
3. [Функциональные возможности](#функциональные-возможности)
4. [Установка и настройка](#установка-и-настройка)
5. [Структура базы данных](#структура-базы-данных)
6. [Использование системы](#использование-системы)
7. [Тестирование проекта](#тестирование-проекта)
8. [Структура проекта](#структура-проекта)
9. [Особенности реализации](#особенности-реализации)

## Описание проекта

Attendance Tracker — это веб-приложение, разработанное для автоматизации процесса учета рабочего времени сотрудников. Система позволяет:

- Сотрудникам регистрировать случаи опозданий, прогулов, отпусков и отсутствий за свой счет
- Администраторам просматривать, фильтровать, подтверждать или отклонять поданные заявки
- Вести централизованный учет всех случаев отсутствия с возможностью поиска и фильтрации

Проект разработан в рамках производственной практики по модулю "Проектирование и разработка информационных систем".

## Технологический стек

- **Backend**: PHP 7.4+
- **Frontend**: HTML5, CSS3, JavaScript (Vanilla)
- **База данных**: MySQL 5.7+
- **Сервер**: Apache (рекомендуется XAMPP)
- **Доступ к БД**: PDO (PHP Data Objects)
- **Тестирование**: PHPUnit 9.6+
- **Контроль версий**: Git

## Функциональные возможности

### Для сотрудников
- Регистрация и авторизация в системе
- Подача заявок об отсутствии с указанием типа, даты и причины
- Просмотр статуса своих заявок (ожидает, подтверждено, отклонено)
- Редактирование заявок до момента их рассмотрения администратором
- Просмотр истории всех поданных заявок

### Для администраторов
- Просмотр всех заявок всех сотрудников
- Подтверждение или отклонение заявок
- Фильтрация заявок по дате, типу отсутствия, статусу
- Поиск заявок по имени сотрудника или email
- Просмотр статистики по заявкам

### Общие функции
- Валидация входных данных
- Защита от SQL-инъекций через подготовленные выражения
- Разграничение прав доступа на основе ролей
- Адаптивный пользовательский интерфейс

## Установка и настройка

### Предварительные требования
- Установленный веб-сервер с поддержкой PHP (рекомендуется XAMPP)
- Система управления базами данных MySQL
- Установленный Composer (для запуска тестов)

### Шаг 1: Настройка базы данных

1. Запустите панель управления XAMPP и активируйте модули Apache и MySQL
2. Откройте phpMyAdmin по адресу: http://localhost/phpmyadmin
3. Создайте новую базу данных с именем `attendance_tracker`
4. Импортируйте дамп базы данных из файла `database.sql`, расположенного в корне проекта

### Шаг 2: Размещение проекта

1. Скопируйте папку проекта в директорию `htdocs` вашего веб-сервера
2. Путь должен выглядеть примерно так: `C:\xampp\htdocs\attendance-tracker\`

### Шаг 3: Проверка конфигурации

Убедитесь, что в файле `config/database.php` указаны правильные параметры подключения к базе данных:

```php
define('DB_HOST', 'localhost');
define('DB_NAME', 'attendance_tracker');
define('DB_USER', 'root');    // Стандартный пользователь XAMPP
define('DB_PASS', '');        // Пароль по умолчанию в XAMPP
```

### Шаг 4: Запуск приложения

1. Откройте браузер
2. Перейдите по адресу: http://localhost/attendance-tracker/
3. Зарегистрируйте первого пользователя через форму регистрации

### Тестовые учетные записи

После импорта базы данных `database.sql` будут созданы тестовые пользователи:

**Администратор:**
- Email: admin@mail.ru
- Пароль: admin123

**Сотрудник:**
- Email: employee@mail.ru
- Пароль: employee123

## Структура базы данных

### Таблица `users`
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('employee', 'admin') DEFAULT 'employee',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Таблица `attendance_records`
```sql
CREATE TABLE attendance_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    date DATE NOT NULL,
    type ENUM('late', 'absence', 'vacation', 'own_account') NOT NULL,
    reason TEXT,
    status ENUM('pending', 'approved', 'rejected') DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

## Использование системы

### Работа сотрудника с системой

1. **Авторизация**: Войдите в систему под своей учетной записью сотрудника
2. **Создание заявки**: Нажмите "Добавить запись", заполните форму (дата, тип отсутствия, причина)
3. **Отслеживание статуса**: В личном кабинете просматривайте статус своих заявок
4. **Редактирование**: При необходимости отредактируйте заявку, если она еще не рассмотрена

### Работа администратора с системой

1. **Авторизация**: Войдите в систему с правами администратора
2. **Просмотр заявок**: На панели администратора отображаются все заявки сотрудников
3. **Фильтрация**: Используйте фильтры для поиска нужных заявок
4. **Обработка**: Подтверждайте или отклоняйте заявки с помощью соответствующих кнопок
5. **Поиск**: Используйте поиск по имени сотрудника для быстрой навигации

## Тестирование проекта

Проект включает комплексную систему тестирования, реализованную с помощью PHPUnit.

### Запуск тестов

1. Установите зависимости Composer:
```bash
composer install
```

2. Запустите все тесты:
```bash
composer test
```

Или напрямую через PHPUnit:
```bash
vendor/bin/phpunit
```

### Структура тестов

```
tests/
├── Unit/                    # Unit-тесты
│   ├── ValidationTest.php  # Тесты валидации данных
│   ├── SessionTest.php     # Тесты работы с сессиями
│   └── PasswordTest.php    # Тесты хеширования паролей
├── Integration/            # Интеграционные тесты
│   ├── DatabaseTest.php    # Тесты базы данных
│   └── AuthTest.php        # Тесты аутентификации
├── TestDatabase.php        # Вспомогательный класс для тестовой БД
└── bootstrap.php          # Инициализация тестовой среды
```

### Покрытие тестами

Проект покрыт 27 тестами, которые выполняют 92 проверки (assertions):

- **Валидация данных**: email, пароль, имя, дата
- **Работа с сессиями**: управление сессиями пользователей
- **Хеширование паролей**: безопасное хранение учетных данных
- **CRUD-операции**: создание, чтение, обновление, удаление записей
- **Ограничения БД**: проверка уникальности, внешних ключей
- **Ролевая модель**: проверка правильности разграничения прав доступа

Для тестов используется отдельная база данных `attendance_tracker_test`, чтобы не затрагивать данные основного приложения.

## Структура проекта

```
attendance-tracker/
├── index.php              # Главная страница (редирект)
├── README.md              # Документация проекта
├── database.sql           # Дамп базы данных
├── composer.json          # Конфигурация зависимостей
├── phpunit.xml           # Конфигурация PHPUnit
├── .gitignore            # Исключения для Git
├── config/
│   └── database.php      # Конфигурация подключения к БД
├── includes/
│   ├── header.php        # Шапка сайта
│   ├── footer.php        # Подвал сайта
│   └── functions.php     # Вспомогательные функции
├── auth/
│   ├── login.php         # Страница входа
│   ├── register.php      # Страница регистрации
│   └── logout.php        # Выход из системы
├── employee/
│   ├── dashboard.php     # Личный кабинет сотрудника
│   ├── add_record.php    # Добавление записи
│   └── edit_record.php   # Редактирование записи
├── admin/
│   ├── dashboard.php     # Панель администратора
│   └── manage_record.php # Управление статусами записей
├── css/
│   └── style.css         # Стили приложения
├── js/
│   └── script.js         # Клиентские скрипты
└── tests/                # Тесты
    ├── Unit/
    ├── Integration/
    ├── TestDatabase.php
    └── bootstrap.php
```

## Особенности реализации

### Безопасность
- **Хеширование паролей**: Использование функции `password_hash()` с алгоритмом bcrypt
- **Защита от SQL-инъекций**: Все запросы к базе данных выполняются через подготовленные выражения PDO
- **Валидация данных**: Проверка всех входных данных на стороне сервера
- **Разграничение прав**: Проверка ролей пользователей на каждой защищенной странице
- **Защита от XSS**: Экранирование выводимых данных с помощью `htmlspecialchars()`

### Архитектура
- **Чистая архитектура**: Разделение логики приложения, работы с данными и представления
- **Модульность**: Каждый функциональный модуль выделен в отдельную директорию
- **Переиспользование кода**: Общие элементы вынесены в отдельные файлы (header, footer, функции)

### Производительность
- **Оптимизированные запросы**: Использование индексов и эффективных SQL-запросов
- **Минимизация подключений**: Единое подключение к базе данных на протяжении сессии

### Масштабируемость
- **Гибкая структура БД**: Возможность добавления новых типов записей и статусов
- **Модульная архитектура**: Легкость добавления нового функционала

## Решение распространенных проблем

### Ошибка подключения к базе данных
1. Убедитесь, что сервер MySQL запущен
2. Проверьте правильность данных в файле `config/database.php`
3. Убедитесь, что база данных `attendance_tracker` существует

### Страница не найдена (404)
1. Проверьте, что проект находится в папке `htdocs`
2. Убедитесь в правильности пути: `http://localhost/attendance-tracker/`
3. Проверьте, запущен ли веб-сервер Apache

### Проблемы с авторизацией
1. Проверьте, включена ли поддержка сессий в PHP
2. Убедитесь, что браузер не блокирует cookies
3. Проверьте правильность введенных учетных данных

## Заключение

Attendance Tracker представляет собой полнофункциональную систему учета посещаемости сотрудников, соответствующую всем современным требованиям к веб-приложениям. Проект демонстрирует практическое применение знаний по разработке информационных систем, включая проектирование базы данных, реализацию бизнес-логики, обеспечение безопасности и создание пользовательского интерфейса.

Система готова к использованию в учебных целях и может служить основой для более сложных решений в области управления человеческими ресурсами.
